!function(t,i){"function"==typeof define&&define.amd?define(["$"],i):"object"==typeof exports?module.exports=i(require("$")):t.Swipe=i($)}(this,function(t){"use strict";var i=function(e){return this instanceof i?(this.container=e.container,this.selector=e.selector||"li",this.fontSize=e.fontSize||18,this.fontSizeDecreate=e.fontSizeDecreate||1,this.heightDecrease=e.heightDecrease||6,this.opacityDecrease=e.opacityDecrease||.2,this.swipeNumber=e.swipeNumber||5,this.onSwipe=e.onSwipe||t.noop,this.activeClassName=e.activeClassName||"active",void this.init()):new i(e)};i.debounceRatio=.4;var e="ontouchstart"in window;return i.prototype={constructor:i,events:{start:e?"touchstart":"mousedown",move:e?"touchmove":"mousemove",end:e?"touchend":"mouseup"},init:function(){this._init(),this.reLayout(),this.bindEvent()},_init:function(){this.lastTranslateX=0;var i=t(this.container),e=i.offset(),s=i.width(),n=i.find("."+this.activeClassName),a=i.find(".swipe-wrapper");this.conPageXBegin=e.left,this.conPageXEnd=e.left+s,this.$container=i,this.$wrapper=a,this.$mainEl=n,this.elWidth=n.width(),this.elHeight=i.height(),this.$elems=i.find(this.selector),this.count=this.$elems.size(),this.initMainIndex=this.initMainIndex||this.$mainEl.index(),this.lastSwipeTranslate=-(this.count-this.swipeNumber)*this.elWidth,this.firstSwipeTranslate=0},bindEvent:function(){t(this.container).on(this.events.start,t.proxy(this.onStart,this)),t(this.container).on(this.events.move,t.proxy(this.onMove,this)),e?t(this.container).on(this.events.end,t.proxy(this.onEnd,this)):t(document.body).on(this.events.end,t.proxy(this.onEnd,this))},onStart:function(t){var i=e?t.changedTouches[0]:t,s=i.pageX,n=i.pageY;this.tracking=!0,this.moving=!1,this.startX=s,this.startY=n},onMove:function(t){if(!this.tracking)return!1;this.moving=!0;var i=e?t.changedTouches[0]:t,s=i.pageX,n=i.pageY,a=s-this.startX,h=n-this.startY;return Math.abs(a)>=Math.abs(h)?(t.preventDefault(),this.debouncing?!1:void this.reLayout(a)):!1},onEnd:function(t){if(this.moving!==!0)return void(this.tracking=!1);this.moving=!1;{var i=e?t.changedTouches[0]:t,s=i.pageX,n=i.pageY,a=s-this.startX;n-this.startY}return this.tracking=!1,this.debouncing?!1:void this.reLayout(a)},reLayout:function(t){t=(t||0)+(this.lastTranslateX||0);var e,s,n=this.getDebounceTranslateValue(t);e=0===n?this.initMainIndex:this.initMainIndex-n,e=e>this.count-1?this.count-1:0>e?0:e,this.curIndex=e,this.onSwipe(e);for(var a,h,o,r,c,u=0,l=this.count;l>u;u++)a=this.$elems.eq(u),h=this.heightDecrease/2*Math.abs(e-u),o=this.elHeight-this.heightDecrease*Math.abs(e-u),r=1-this.opacityDecrease*Math.abs(e-u),c=this.fontSize-this.fontSizeDecreate*Math.abs(e-u),a.css({"-webkit-transform":"translateY("+h+"px)",transform:"translateY("+h+"px)",height:o,opacity:r,"font-size":c}),u===e?a.addClass(this.activeClassName):a.removeClass(this.activeClassName);t<this.lastSwipeTranslate?(s=this.lastSwipeTranslate,t=s+(t-s)*i.debounceRatio):t>this.firstSwipeTranslate&&(s=this.firstSwipeTranslate,t=s+(t-s)*i.debounceRatio),this.$wrapper.css({"-webkit-transform":"translateX("+t+"px)",transform:"translateX("+t+"px)"}),this.tracking!==!0&&this.debounce(t)},debounce:function(i){this.debouncing=!0;var e=this.elWidth,s=this;i=i<this.lastSwipeTranslate?this.lastSwipeTranslate:i>this.firstSwipeTranslate?this.firstSwipeTranslate:this.getDebounceTranslateValue(i)*e,this.lastTranslateX=i,this.$wrapper.on("webkitTransitionEnd",function(){t(this).css({"transition-duration":"0ms"}),s.debouncing=null}),function(t){setTimeout(function(){t.debouncing=null},300)}(s),this.$wrapper.css({"-webkit-transform":"translateX("+i+"px)",transform:"translateX("+i+"px)","transition-duration":"300ms"})},reset:function(){!function(t){setTimeout(function(){t._init(),t.translateTo(t.curIndex)},300)}(this)},translateTo:function(t){this.reLayout(this.getTranslateWidth(t))},getTranslateWidth:function(t){return(this.initMainIndex-t)*this.elWidth-this.lastTranslateX},getDebounceTranslateValue:function(t){var i,e=this.elWidth;return i=t>=0?Math.floor(t/e):Math.ceil(t/e),i===-0?0:i}},i});